##  STD_Pytorch

Due to the limited time to complete this project and my poor comprehend to the structure of such model, this code may not a correct implement of STD model, in other word, it may not work.

### Datasetï¼šKITTI

The following are demo of ground_truth

- BEV

<img src="imgs\006397_bev.jpg" alt="006397_bev" style="zoom:50%;" />

- camera2_view(left_rgb)

<img src="imgs\006397_project.jpg" alt="006397_bev" style="zoom:50%;" />

### First Stage PGM

This stage is to generate the proposal. Because of the limitation of GPU source, I only keep up to 128 proposal in training but not the 300 in the paper.

the following is a demo of the generated proposal

<img src="imgs\005602_bev.jpg" alt="005602_bev" style="zoom:50%;" />

Due to the limited data we used for training(200 raw point clouds), the model may not perform well in the angle prediction 

### Second Stage PointsPool + Box Prediction

The prediction are as following:

BEV red is the ground truth white is the proposal and (may not be seen) blue is the predicted bounding box

<img src="imgs\006181_bev.jpg" alt="006181_bev" style="zoom:50%;" />

And the corresponding project image

red is ground truth, blue is the predicted bounding box and green is the corresponding proposal

<img src="imgs\006181_project.jpg" alt="006181_project" style="zoom:67%;" />

## Usage

with the Pytorch environment

I didn't use arguments parser to convert the parameters.

You can adjust the arguments in these file:

- utils/dataset.py: change the dataset dir and the size of dataset and number of the points in each point cloud
- models/STD.py: change the positive 3D IoU threshold of proposal in the second stage and the maximum number of proposals generated by PGM
- train.py: change the output directory of PGM model training
- train_second_stage.py: change the path of PGM weight and the output directory of second stage model training



then you can just use the following instruction to train the model

```python
python train.py # train the PGM

python train_second_stage.py # train the second stage model
```

and you can use detect.py to detect your data, the parameters can be adjusted in that file

